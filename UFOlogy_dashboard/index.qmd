---
title: "It's a bird, it's a plane - no it's a UFO!"
format: 
  dashboard:
    scrolling: true
author: Git Culture
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = F, message = F)

# Replace root directory path with wherever github repo is locally stored for user
knitr::opts_knit$set(root.dir = "/users/jacquelineferri/desktop/sppw/biostats777-final-project-git-culture")

library(dplyr)
library(ggplot2)
library(lubridate)
library(readr)
library(ggridges)
library(wordcloud)
library(tm)
library(stringr)
library(png)
library(grid)
library(tidyverse)
library(leaflet)
library(leaflet.extras)
library(sf)
library(tigris)
```

# Home

**Welcome to the UFOlogy Dashboard!**

This dashboard provides the opportunity to explore supernatural sightings and their associations with weather patterns and potential years of life lost across California counties.

This dashboard was created by Sonia Dhawan, Ananya Bhaktaram. Jacqueline Ferris and Curtis Ehlert in fulfillment of Project 4 for PH.140.777, Statistical Programming Paradigms and Workflows at the Johns Hopkins Bloomberg School of Public Health.

::: callout.warning
This dashboard was created in December 2025 as a practice of programmatic skills learned in PH.140.777 and does not represent real scientific insight into the credibility of UFO or Bigfoot sightings or any potential associations with health related phenomena.
:::

# Overview

## Dashboard Purpose

This interactive dashboard provides a unique perspective on supernatural phenomena in California by providing visualizing data on the following:

-   **UFO Sightings -** concentration and temporal trends of UFO reports

-   **Bigfoot Sightings -** geographic distributions of reported Bigfoot encounters

-   **Years of Potential Life Lost (YPLL) Rate -** temporal and geographic trends of YPLL rates

Our goal is to provide users the opportunity to explore interesting associations between the distribution of these phenomena and to delve into their geographic and temporal distributions across California's 58 counties.

### How to Use This Dashboard

1.  **Explore** data by using the tabs above to look at patterns across California throughout the years.
2.  **Compare** different trends to come to your own conclusions.
3.  **Download** data and R-code from our github repository to recreate our analysis for yourselves.

::: callout-tip
**Data Access**

Access raw data, analysis documentation, and plot visualization code from our github.

Github Repository: <https://github.com/jferri3/biostats777-final-project-git-culture>
:::

### Data Sources

The data used in this dashboard came from the following sources:

-   **UFO sightings** were obtained from CORGIS scraped and cleaned data that was originally collected by National UFO Reporting Center

    -   This contained point level data of the site of reported UFO incident, as well as city, county, and type of observation from 2004-2014

-   **Bigfoot Data** scraped and cleaned data was obtained from Kaggle that was originally collected by the Bigfoot Field Researchers Organization.

    -   This contained documented Bigfoot sightings between 2004-2014 as well as State, County and date.

-   **Weather Data** was scraped from the National Oceanic and Atmospheric Administration (NOAA)

    -   We extracted monthly average precipitation, and monthly average temperature data for California counties between 2004-2014.

-   **YPLL** data came from the Robert Wood Johnson Foundations County Health Rankings

    -   This contained YPLL rates at the County level in California from 2010-2025

# Temporal Variation of UFO Sightings

### Overview

The National UFO Reporting Center (NUFORC) has documented over **\[X,XXX\] UFO reports** between 1995-2018. The following analysis shows a **significant increase in UFO sightings over time**, with distinct, temporal, environmental and phenomenological differences.

The United States has the highest overall number of reported UFO sightings of any country in the world. Moreover, California has the highest concentration of reported UFO sightings of any state in the U.S. It's diverse, geography, climate, and combination of rural and urban areas provides an ideal location to explore how UFO reports may be influenced by a variety of factors.

### Note about Data

::: callout-note
The following data visualizations are based off of reported phenomenon documented and voluntarily submitted by witnesses to NUFORC. Consequently, the data should be interpreted as a behavioral response data based off of individual experiences rather than verified and confirmed extraterrestrial activity.
:::

### Key Findings

::: callout.tip
**Key Findings**

-   The number of UFO sightings in California have increased over time.

-   Seasonal variation

-   Variation by type
:::

## Temporal Analysis {height="25%"}

**The two charts below display the increased frequency of UFO reports over time in California between 2004-2014. The first graph displays the cumulative increase of UFO sightings over time and the graph in the second tab shows the distribution of UFO sightings over time by shape.**

### Graphs {.tabset}

#### Cumulative View

```{r, echo=FALSE}
ggplot2::ggplot() + ggplot2::annotation_raster(png::readPNG("plot-images/cumulative_sightings.png"), 0, 1, 0, 1) + ggplot2::theme_void()
```

#### By Shape

```{r, echo=FALSE, fig.show='asis'}
## quarto dashboard doesn't render the plot b/c it's html and isn't read as a figure. use ggplot OR wrap it in a grid to make it a figure object
grid::grid.raster(png::readPNG("plot-images/UFOsightings_time_space.png"))

```

:::: grid
::: g-col-6
### Day vs Night Sightings

**When do UFOs Appear?** Explore how time of day influences the likelihood of spotting a UFO.

```{r, echo=FALSE}
grid::grid.raster(png::readPNG("plot-images/day_night_UFOsightings.png"))
```
:::
::::

## Break to separate out Blocks 2 and 3

::: callout
**Seasonal Variation:**

The following graphs displays show seasonal variation in UFO sightings in California. Explore the differences in sightings based on average temperature, month, and season
:::

## Seasonal Variation {height="10%"}

### Graphs {.tabset}

#### Temperature Change

```{r, echo=FALSE}
grid::grid.raster(png::readPNG("plot-images/UFOsightings_temperature.png"))
```

#### Sightings by Month

```{r, echo=FALSE}
grid::grid.raster(png::readPNG("plot-images/monthly_sightings.png"))
```

#### Seasonal Variation

```{r, echo=FALSE}
grid::grid.raster(png::readPNG("plot-images/seasonal_sightings.png"))
```

:::: grid
::: g-col-6
## County Observations

```{r, echo=FALSE}
grid::grid.raster(png::readPNG("plot-images/top15_counties.png"))
```
:::
::::

:::: grid
::: g-col-6
## Duration

```{r, echo=FALSE}
grid::grid.raster(png::readPNG("plot-images/UFOencounter_duration_shape.png"))
```
:::
::::

# UFO Maps

## UFO sightings, bigfoot, and precipitation

::: {layout-ncol="1"}
```{r, echo=FALSE, message=FALSE, warning=FALSE, results='hide'}
# Load and prepare data
df <- read_csv("nuforc_county_weather_bigfoot_with_census_population.csv") %>%
  mutate(
    County = str_trim(County),
    County = str_to_title(County),
    County = if_else(str_detect(County, "County$"), County, paste0(County, " County"))
  )

# Filter for California only
df_ca <- df %>% 
  filter(Location.State == "CA") %>%
  filter(!is.na(County), County != "")

ca_counties <- counties(state = "CA", cb = TRUE, class = "sf") %>%
  mutate(NAME = str_to_title(NAME)) %>%
  mutate(NAME = if_else(str_detect(NAME, "County$"), NAME, paste0(NAME, " County")))

# Clean county names in data
df_ca <- df_ca %>%
  mutate(County = if_else(str_detect(County, "County$"), County, paste0(County, " County")))

# County level data
county_precip <- df_ca %>%
  group_by(County) %>%
  summarize(Avg_Precip = mean(Avg_Precip_Month_County, na.rm = TRUE), .groups = "drop")

ufo_counts <- df_ca %>%
  filter(sighting_type == "UFO") %>%
  count(County, name = "UFO_Count")

bigfoot_counts <- df_ca %>%
  filter(sighting_type == "Bigfoot") %>%
  count(County, name = "Bigfoot_Count")

county_pop <- df_ca %>%
  group_by(County) %>%
  summarize(population = first(population), .groups = "drop")

# Combine all county data
county_data <- county_precip %>%
  left_join(county_pop, by = "County") %>%
  left_join(ufo_counts, by = "County") %>%
  left_join(bigfoot_counts, by = "County") %>%
  mutate(
    UFO_Count = replace_na(UFO_Count, 0),
    Bigfoot_Count = replace_na(Bigfoot_Count, 0),
    UFO_per_100k = if_else(!is.na(population) & population > 0, 
                           UFO_Count / population * 100000, NA_real_),
    Bigfoot_per_100k = if_else(!is.na(population) & population > 0, 
                               Bigfoot_Count / population * 100000, NA_real_)
  )

# Map making
ca_map <- ca_counties %>%
  left_join(county_precip, by = c("NAME" = "County"))

#Blue color for precipitation
precip_pal <- colorNumeric("Blues", domain = county_data$Avg_Precip, na.color = "#f0f0f0")

# Create base map
orig_map <- leaflet() %>%
  addProviderTiles("CartoDB.Positron") %>%
  addPolygons(
    data = ca_map,
    fillColor = ~precip_pal(Avg_Precip),
    fillOpacity = 0.6,
    color = "white",
    weight = 1,
    smoothFactor = 0.3,
    group = "Precipitation Map",
    label = ~paste0(NAME, ": ", ifelse(is.na(Avg_Precip), "No data", 
                                       paste0(round(Avg_Precip, 2), " in")))
  ) %>%
  addLegend(
    "bottomleft",
    pal = precip_pal,
    values = county_data$Avg_Precip,
    title = "Avg Monthly Precipitation (in)",
    na.label = "No data"
  )

# Add UFO heatmap and points
ufo_data <- df_ca %>% filter(sighting_type == "UFO", !is.na(lon), !is.na(lat))
orig_map <- orig_map %>%
  addHeatmap(
    data = ufo_data,
    lng = ~lon, lat = ~lat,
    radius = 25,
    blur = 30,
    max = 0.01,
    group = "UFO Heatmap"
  ) %>%
  addCircleMarkers(
    data = ufo_data,
    lng = ~lon, lat = ~lat,
    radius = 3,
    color = "blue",
    fillOpacity = 0.7,
    label = ~paste("UFO in", County),
    group = "UFO Points"
  )

# Adding Bigfoot heatmap and points
bigfoot_data <- df_ca %>% filter(sighting_type == "Bigfoot", !is.na(lon), !is.na(lat))
orig_map <- orig_map %>%
  addHeatmap(
    data = bigfoot_data,
    lng = ~lon, lat = ~lat,
    radius = 25,
    blur = 30,
    max = 0.01,
    group = "Bigfoot Heatmap",
    gradient = c("0" = "black", "0.3" = "red", "0.7" = "orange", "1" = "yellow")
  ) %>%
  addCircleMarkers(
    data = bigfoot_data,
    lng = ~lon, lat = ~lat,
    radius = 3,
    color = "red",
    fillOpacity = 0.7,
    label = ~paste("Bigfoot in", County),
    group = "Bigfoot Points"
  ) %>%
  addLayersControl(
    baseGroups = c("Precipitation Map"),
    overlayGroups = c("UFO Heatmap", "Bigfoot Heatmap", "UFO Points", "Bigfoot Points"),
    options = layersControlOptions(collapsed = FALSE)
  )
```

```{r, echo=FALSE}
orig_map
```
:::

# Health data

**Years of Potential Life Lost vs. Weather Trends**

##  {.tabset}

### YPLL

```{r, echo=FALSE}
grid::grid.raster(png::readPNG("plot-images/YPLL_plot.png"))
```

### Precipitation

```{r, echo=FALSE}
grid::grid.raster(png::readPNG("plot-images/precip_plot.png"))
```

### Temperature

```{r, echo=FALSE}
grid::grid.raster(png::readPNG("plot-images/temp_plot.png"))
```

## page break between tabset cards

**Years of Potential Life Lost vs. UFO Sightings by County over the Years**

##  {.tabset}

### YPLL

```{r, echo=FALSE}
grid::grid.raster(png::readPNG("plot-images/YPLL_plot.png"))
```

### 2004

```{r, echo=FALSE}
grid::grid.raster(png::readPNG("plot-images/sightings_2004_plot.png"))

```

### 2007

```{r, echo=FALSE}
grid::grid.raster(png::readPNG("plot-images/sightings_2007_plot.png"))

```

### 2009

```{r, echo=FALSE}
grid::grid.raster(png::readPNG("plot-images/sightings_2009_plot.png"))

```

### 2011

```{r, echo=FALSE}
grid::grid.raster(png::readPNG("plot-images/sightings_2011_plot.png"))

```

### 2013

```{r, echo=FALSE}
grid::grid.raster(png::readPNG("plot-images/sightings_2013_plot.png"))

```

### 2014

```{r, echo=FALSE}
grid::grid.raster(png::readPNG("plot-images/sightings_2014_plot.png"))
```

## page break after tabs

**Analysis?**

There seems to be a connection between the dryer, hotter areas of the state (southern portion) and higher numbers of UFO sightings. This is consistent between 2004 and 2014.
